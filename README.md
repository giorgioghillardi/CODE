# SOFTv2
This is the rewrite of the Synchrotron-detecting Orbit Following Toolkit (SOFT),
a fast synthetic radiation diagnostic toolkit for runaway electrons in tokamaks.
Given an axisymmetric magnetic field and a runaway electron distribution
function, SOFT can produce bremsstrahlung and synchrotron radiation images,
spectra and more. This version of the code is a complete rewrite in C++ of the
original code, featuring a better code structure, more efficient algorithms
(sometimes by orders of magnitude), a slightly more user-friendly interface and
some new physics.

![Synthetic synchrotron spot in a circular tokamak](https://github.com/hoppe93/SOFT2/raw/master/examples/synchrotron.png "Synthetic synchrotron spot in a circular tokamak")

## Documentation
The online documentation for SOFT2 is available at https://soft2.readthedocs.io/en/latest/.

## Required software
In order to compile and run SOFT2, the following software must be installed on your system:

- [CMake](https://cmake.org/) version 3.9 or later
- A C++ compiler with support for C++17 and OpenMP (such as gcc >= 7)
- [GNU Scientific Library](https://www.gnu.org/software/gsl/) version 2.0 or later
- [softlib](https://github.com/hoppe93/softlib) (latest version)

For file output, you need one of the following two:

- [HDF5](https://www.hdfgroup.org/) for reading/writing HDF5 and (Matlab) MAT files **(highly recommended)**
- [MATLAB](https://www.mathworks.com/) for reading/writing (Matlab) MAT files

*We highly recommend installing and using HDF5 with SOFT2 instead of Matlab.
Input and output files can still be operated on by Matlab (with the '-v7.3' for
writing) when generated by the HDF5 library.*

For MPI parallelization (running on clusters), you will also need and
implementation of the MPI standard installed, such as:

- [OpenMPI](https://www.open-mpi.org/)
- [MPICH](https://www.mpich.org/)

## Compilation
Once all required software is installed, compiling SOFT2 is as easy as going
into the ``build`` directory and running
```bash
$ cmake ../ && make -j N
```
where *N* is the number of threads to use when compiling. Once finished, the
SOFT2 executable is available as ``soft`` under ``build/src/``. For more details
about how to compile SOFT2, including a list of configuration options that can
be specified to CMake, see the [SOFT2 documentation](https://soft2.readthedocs.io/en/latest).

## About the author
SOFT is developed by the [Plasma Theory group](http://ft.nephy.chalmers.se) at
the Department of Physics, Chalmers University of Technology. Lead maintainer is
Mathias Hoppe.

## How to cite
If you use SOFT in your research, you should cite the SOFT paper:

M. Hoppe *et al* 2018 [*Nucl. Fusion* **58** 026032](https://doi.org/10.1088/1741-4326/aa9abb)

BibTeX:
```
@article {Hoppe2018,
	title = {{SOFT}: a synthetic synchrotron diagnostic for runaway electrons},
	author = {M. Hoppe and O. Embr{\'{e}}us and R. A. Tinguely and R. S. Granetz and A. Stahl and T. F{\"{u}}l{\"{o}}p},
	year = 2018,
	month = {jan},
	publisher = {{IOP} Publishing},
	volume = {58},
	number = {2},
	pages = {026032},
	journal = {Nuclear Fusion},
	doi = {10.1088/1741-4326/aa9abb},
	url = {https://doi.org/10.1088%2F1741-4326%2Faa9abb},
    eprint = {https://arxiv.org/abs/1709.00674}
}
```

## Publications
For a partial list of publications using SOFT, see https://ft.nephy.chalmers.se/retools/soft/.

